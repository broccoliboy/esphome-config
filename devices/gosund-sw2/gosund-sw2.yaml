substitutions:
  # default name is used as base for MAC suffix unique name generated by ESPHome
  name: "gosund-sw2"
  friendly_name: "Gosund SW2 Dimmer Switch"

esphome:
  project:
    name: broccoliboy.gosund-sw2
    version: "1.0"
  includes:
    - devices/gosund-sw2/gosund-sw2.h

packages:
  hardware: !include ../../hardware/esp01_1m.yaml
  base: !include ../../components/base.yaml

logger:
  level: INFO
  baud_rate: 0  # This must be 0 to prevent conflicts with the dimmer

status_led:
  pin:
    number: GPIO12
    inverted: true

output:
  - platform: gpio
    id: gosund_led
    pin: GPIO13

binary_sensor:
  - platform: gpio
    id: gosund_button
    pin:
      number: GPIO4
      inverted: true
    on_click:
      min_length: 50ms
      max_length: 500ms
      then:
        - light.toggle: gosund_sw2

uart:
  - id: gosund_uart
    rx_pin: GPIO3
    tx_pin: GPIO1
    baud_rate: 115200

light:
  - platform: custom
    lambda: |-
      auto gosund_sw2 = new GosundSW2Light(id(gosund_uart), id(gosund_led));
      App.register_component(gosund_sw2);
      return {gosund_sw2};
    lights:
      - id: gosund_sw2
        name: Gosund SW2 Dimmer

# number:
#   - platform: template
#     name: "Output range min"
#     id: output_range_min
#     optimistic: true
#     min_value: 0
#     max_value: 100
#     step: 1
#     restore_value: true
#     initial_value: 0
#   - platform: template
#     name: "Output range max"
#     id: output_range_max
#     optimistic: true
#     min_value: 0
#     max_value: 100
#     step: 1
#     restore_value: true
#     initial_value: 100

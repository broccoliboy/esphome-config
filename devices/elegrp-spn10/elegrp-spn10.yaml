# Thank you to bennydiamond for pin numbers and inspiration for this config :)
# https://github.com/bennydiamond/elegrp_spn10_esphome_template/blob/master/.base.elegrp.spn10_template.yaml

substitutions:
  # default name is used as base for MAC suffix unique name generated by ESPHome
  name: elegrp-spn10
  friendly_name: "ELEGRP SPN10 Switch"
  comment: ""

esphome:
  project:
    name: "broccoliboy.elegrp-spn10"
    version: "1.0"

packages:
  hardware: !include ../../hardware/boards/cb2s.yaml
  base: !include ../../common/base.yaml

switch:
  - platform: gpio
    name: "Relay"
    id: output_relay
    pin:
      number: P7
      inverted: False
    on_turn_on:
      - light.turn_off: status_led_light
    on_turn_off:
      - light.turn_on: status_led_light
  
binary_sensor:
  - platform: gpio
    id: button_up
    pin: 
      number: P6
      mode:
        input: True
        pullup: True
      inverted: True
    on_press:
      - switch.toggle: output_relay
  - platform: gpio
    id: button_down
    pin: 
      number: P23
      mode:
        input: True
        pullup: True
      inverted: True
    on_press:
      - switch.toggle: output_relay

output:
  # White LED
  - platform: libretiny_pwm
    id: led_pwm_output
    pin:
      number: P24
      inverted: True
    frequency: 1000 Hz
    min_power: 0.01
    zero_means_zero: True

light:
  - platform: status_led
    id: status_led_light
    output: led_pwm_output
    restore_mode: ALWAYS_ON
